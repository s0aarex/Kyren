<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kyren â€” Source Hub</title>

  <link rel="icon" href="./assets/favicon.png">
  <link rel="stylesheet" href="./assets/style.css" />
</head>

<body>
  <!-- fundo desenho -->
  <div id="scribbles"></div>

  <!-- topo -->
  <div class="topbar">
    <div class="pillbar">
      <div class="brand">
        <span class="brandDot"></span>
        <span>KYREN â€” SOURCE HUB</span>
      </div>

      <div class="pillLinks">
        <a class="pillBtn" href="https://github.com/s0aarex/Kyren" target="_blank" rel="noreferrer">ğŸ‘¾ GitHub</a>
        <a class="pillBtn" href="./feedback.html">ğŸ’¬ Feedback</a>
        <button class="pillBtn" id="langToggle" type="button">ğŸŒ PT-BR â†’ EN</button>
      </div>
    </div>
  </div>

  <main class="wrap">
    <!-- hero -->
    <section class="hero">
      <h1 class="heroTitle">Kyren <em>official</em></h1>

      <p class="heroSub" id="sub">
        Site oficial da source Kyren â€” guia rÃ¡pido, patch notes e uma Ã¡rea pra pedidos/sugestÃµes/bugs (tudo rastreÃ¡vel no GitHub).
      </p>

      <div class="heroBtns">
        <a class="pillBtn" href="./how-to-use.html">ğŸš€ Como usar</a>
        <a class="pillBtn" href="./patch-notes.html">ğŸ§¾ Patch notes</a>
        <a class="pillBtn" href="./feedback.html">ğŸ’¬ Feedback</a>
      </div>

      <hr class="hr" />
    </section>

    <!-- cards -->
    <div class="kicker" id="kicker1">O QUE TEM AQUI</div>

    <section class="grid3">
      <article class="card">
        <h3>âš¡ Quick setup</h3>
        <p>Passo a passo curto e direto pra importar a source no Hydra.</p>
        <a class="miniLink" href="./how-to-use.html" id="c1">Abrir guia â†’</a>
      </article>

      <article class="card">
        <h3>ğŸ§© Updates</h3>
        <p>MudanÃ§as organizadas: o que entrou, o que mudou e o que foi corrigido.</p>
        <a class="miniLink" href="./patch-notes.html" id="c2">Ver patch notes â†’</a>
      </article>

      <article class="card">
        <h3>ğŸŸ¨ Tickets</h3>
        <p>Pedidos, sugestÃµes e bugs viram tickets â€” dÃ¡ pra acompanhar e comentar.</p>
        <a class="miniLink" href="./feedback.html" id="c3">Abrir feedback â†’</a>
      </article>
    </section>

    <!-- latest patch -->
    <div class="kicker" style="margin-top:22px" id="kicker2">ÃšLTIMO PATCH</div>

    <section class="latestWrap">
      <article class="latestCard" id="latestPatchCard">
        <h4>â³ Carregando patch notesâ€¦</h4>
        <div class="meta">Se travar, confere se `docs/patch-notes.json` existe.</div>
      </article>

      <aside class="sideCard">
        <a class="pillBtn" href="./patch-notes.html" id="latest_btn">ğŸ§¾ Ver patch notes</a>
      </aside>
    </section>

    <!-- footer / atalhos -->
    <section class="shortcuts">
      <div>
        <a class="pillBtn" href="./feedback.html">ğŸ“Œ Abrir formulÃ¡rios</a>
        <span class="smallNote">Kyren â€” Source Hub</span>
      </div>

      <div>
        <a class="pillBtn" href="https://github.com/s0aarex/Kyren" target="_blank" rel="noreferrer">ğŸ‘¾ Ver repo</a>
      </div>
    </section>
  </main>

  <script>
  function pickText(val, lang){
    if (!val) return "";
    if (typeof val === "string") return val;
    if (typeof val === "object") {
      return val[lang] || val["pt-BR"] || val["en"] || "";
    }
    return String(val);
  }

  function pickList(list, lang){
    if (!Array.isArray(list)) return [];
    return list.map(item => pickText(item, lang)).filter(Boolean);
  }

  async function kyrenLoadLatestPatch(){
    const lang = localStorage.getItem("kyren_lang") || "pt-BR";

    try{
      const res = await fetch("./patch-notes.json", { cache: "no-store" });
      const patches = await res.json();
      const latest = patches?.[0];
      const card = document.getElementById("latestPatchCard");
      if(!latest || !card) return;

      const title = pickText(latest.title, lang);
      const summary = pickText(latest.summary, lang);

      const items = [
        ...pickList(latest.added, lang).slice(0,2),
        ...pickList(latest.fixed, lang).slice(0,1),
        ...pickList(latest.changed, lang).slice(0,1),
      ];

      card.innerHTML = `
        <h4>ğŸš€ ${latest.version} â€¢ ${title}</h4>
        <div class="meta">ğŸ“… ${latest.date} <span style="opacity:.55">â€¢</span> ${summary}</div>
        ${items.length ? `<ul>${items.map(x => `<li>${x}</li>`).join("")}</ul>` : ""}
        ${latest.stats ? `
          <div class="stats">
            <span>ğŸ“Œ +${latest.stats.added ?? 0}</span>
            <span>ğŸ§· ${latest.stats.updated ?? 0}</span>
            <span>ğŸ§¼ ${latest.stats.cleaned ?? 0}</span>
          </div>` : ``}
      `;
    }catch(e){
      const card = document.getElementById("latestPatchCard");
      if(card) card.innerHTML = `<h4>âš ï¸ NÃ£o carregou</h4><div class="meta">Confere se <b>docs/patch-notes.json</b> existe e Ã© JSON vÃ¡lido.</div>`;
    }
  }

  kyrenLoadLatestPatch();
</script>

    // --- idioma (simples) ---
    const copy = {
      "pt-BR": {
        btn:"ğŸŒ PT-BR â†’ EN",
        sub:"Site oficial da source Kyren â€” guia rÃ¡pido, patch notes e uma Ã¡rea pra pedidos/sugestÃµes/bugs (tudo rastreÃ¡vel no GitHub).",
        kicker1:"O QUE TEM AQUI",
        kicker2:"ÃšLTIMO PATCH",
        c1:"Abrir guia â†’",
        c2:"Ver patch notes â†’",
        c3:"Abrir feedback â†’",
        latest_btn:"ğŸ§¾ Ver patch notes"
      },
      "en": {
        btn:"ğŸŒ EN â†’ PT-BR",
        sub:"Official Kyren source site â€” quick guide, patch notes, and a place for requests/suggestions/bugs (all tracked on GitHub).",
        kicker1:"WHAT'S HERE",
        kicker2:"LATEST PATCH",
        c1:"Open guide â†’",
        c2:"View patch notes â†’",
        c3:"Open feedback â†’",
        latest_btn:"ğŸ§¾ View patch notes"
      }
    };

    function setLang(lang){
      localStorage.setItem("kyren_lang", lang);
      document.documentElement.lang = lang === "en" ? "en" : "pt-BR";
      document.getElementById("langToggle").textContent = copy[lang].btn;
      document.getElementById("sub").textContent = copy[lang].sub;
      document.getElementById("kicker1").textContent = copy[lang].kicker1;
      document.getElementById("kicker2").textContent = copy[lang].kicker2;
      document.getElementById("c1").textContent = copy[lang].c1;
      document.getElementById("c2").textContent = copy[lang].c2;
      document.getElementById("c3").textContent = copy[lang].c3;
      document.getElementById("latest_btn").textContent = copy[lang].latest_btn;
    }

    const saved = localStorage.getItem("kyren_lang") || "pt-BR";
    setLang(saved);

    document.getElementById("langToggle").addEventListener("click", () => {
      const current = localStorage.getItem("kyren_lang") || "pt-BR";
      setLang(current === "pt-BR" ? "en" : "pt-BR");
    });
  </script>
</body>
</html>
